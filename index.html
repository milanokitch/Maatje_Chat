<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maatje AI â€“ Chatbot</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <img src="/images/logo_abrona.png" alt="Abrona Logo" class="logo">
        
        <div class="header-text">
            <h1>Maatje AI â€“ Chatbot</h1>
            <p>Jouw digitale maatje</p>
        </div>

        <button id="logoutBtn" class="logout-btn" style="display: none;">Uitloggen</button>
    </header>

    <!-- Main Container -->
    <main class="container">
        <!-- Left Section: Information -->
        <section class="welcome-section">
            <h2>Welkom bij Maatje AI</h2>
            <p>Ons chatbot-platform biedt 24/7 ondersteuning met:</p>
            <ul>
                <li>âœ“ Snelle en vriendelijke antwoorden</li>
                <li>âœ“ Veilige en vertrouwelijke communicatie</li>
                <li>âœ“ Altijd beschikbaar voor jou</li>
                <li>âœ“ Personaliseerde ondersteuning</li>
            </ul>
            <p class="info-text">Stuur een bericht in het chatvenster en ontvang direct antwoord. Onze AI-assistent is hier om je te helpen!</p>
        </section>

        <!-- Right Section: Chat Window -->
        <section class="chat-section">
            <div class="chat-header-controls">
                <button id="fullscreenBtn" class="fs-btn" title="Volledig scherm">â›¶</button>
            </div>

            <div class="chat-window" id="chatWindow">
                <div class="message bot-message" style="opacity: 0; transition: opacity 0.5s;">
                    <div class="message-content">Hallo! ðŸ‘‹ Ik ben Maatje AI. Hoe kan ik je vandaag helpen?</div>
                </div>
            </div>

            <div class="chat-input-container">
                <input 
                    type="text" 
                    id="messageInput" 
                    class="chat-input" 
                    placeholder="Typ je bericht hier..."
                    autocomplete="off"
                >
                <button id="sendBtn" class="send-btn">Verstuur</button>
            </div>
            <div class="legal-footer">
                <p>ðŸ”’ <strong>Privacy & Veiligheid:</strong> Je gesprekken zijn privÃ©. Alleen als er gevaar dreigt, krijgt je begeleider een seintje. <a href="privacy.html">Lees de voorwaarden</a>.</p>
            </div>
        </section>

        <div id="chatbot-description" class="info-section">
            <h2>Chatbot voor Abrona</h2>
            <p>De AI Chatbot voor Abrona biedt gebruikers een interactieve ervaring door vragen te beantwoorden en ondersteuning te bieden. Deze chatbot is ontworpen om efficiÃ«nt en effectief te communiceren, waardoor gebruikers snel de informatie krijgen die ze nodig hebben.</p>
        </div>

        <div class="footer-logo">
            <img src="/images/logo_abrona.png" alt="Abrona Logo">
        </div>
    </main>

            <!-- Copilot instructions: zie `.github/copilot-instructions.md` voor volledige richtlijnen. -->

    <style>
        #chatbot-description {
            margin: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
    </style>

        <!-- Supabase client toevoegen -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script>
            // Supabase client initialiseren (hergebruik singleton indien aanwezig)
            const { createClient } = window.supabase;
            let supabaseClient = window.__maatjeSupabaseClient ?? null;

            if (!supabaseClient) {
                supabaseClient = createClient(
                    'https://fhynxjujbwxxdxegomki.supabase.co',
                    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZoeW54anVqYnd4eGR4ZWdvbWtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyNjkyMzYsImV4cCI6MjA4MDg0NTIzNn0.tTXCi7ptSw1P6IVouGwTZt5DMbCcTZofqpXO-P0UA3k'
                );
                window.__maatjeSupabaseClient = supabaseClient;
            }

            // Bewaar referentie voor andere scripts zonder library te overschrijven
            window.supabaseClient = supabaseClient;

            // Check of gebruiker is ingelogd
            async function checkAuth() {
                const { data: { session } } = await supabaseClient.auth.getSession();
                
                if (!session) {
                    // Niet ingelogd, redirect naar login
                    window.location.href = 'login.html';
                } else {
                    // Ingelogd, toon logout knop
                    document.getElementById('logoutBtn').style.display = 'block';
                    console.log('âœ… Gebruiker ingelogd:', session.user.email);
                }
            }

            // Logout functie
            document.getElementById('logoutBtn')?.addEventListener('click', async () => {
                await supabaseClient.auth.signOut();
                window.location.href = 'login.html';
            });

            // Check auth bij laden pagina
            checkAuth();
        </script>
        <script src="script.js"></script>
</body>
</html>
